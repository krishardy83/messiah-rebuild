---
import Icon from "../../components/icon.astro";

const items = [
  {
    name: "Faith-Intellect",
    preview: "https://www.messiah.edu/site/custom_scripts/styles/img/about/see-anew-1.png",
    intro: "The “outcome” of bringing together faith and intellect is:",
    outcome: "A discerning spirit",
    description:
      "Philosophy class: Existentialism.<br />I can see the problem<br />the longing for meaning<br />in a world reluctant to give it.<br />The professor asks:<br />As Christians, what do we do with this?<br />At Messiah,<br />I grapple with ideas from all angles<br />until I see the world’s realities<br />in a much deeper way.",
    banner: "https://www.messiah.edu/images/1_FaithIntellect.jpg",
  },
  {
    name: "Preparation-Imagination",
    preview: "https://www.messiah.edu/site/custom_scripts/styles/img/about/see-anew-2.png",
    intro: "The “outcome” of bringing together faith and intellect is:",
    outcome: "Real-world creativity",
    description:
      "Real problems.<br />A real village in Africa<br />needs a water pump.<br />From our campus,<br />we take it on.<br />We brainstorm.<br />We analyze, research, design.<br />We fail and try again.<br />We solve it.<br />We don't just dream of all we'll do after we graduate from Messiah.<br />We do it now.",
    banner: "https://www.messiah.edu/images/6_PreparationImagination.jpg",
  },
  {
    name: "Harmony-Difference",
    preview: "https://www.messiah.edu/site/custom_scripts/styles/img/about/see-anew-3.png",
    intro: "The “outcome” of bringing together harmony and difference is: ",
    outcome: "A passion for Christian community",
    description:
      "Before I came to Messiah,<br />I thought I had to agree<br />before I could listen.<br />But our conversations here<br />are full of different perspectives.<br />So when someone has something to say,<br />I listen.<br /><br />Maybe I will agree with her,<br />but even if I don't, I respond thought-<br />fully, realizing she cares as deeply about her faith<br />as I do about mine.<br />At Messiah, our core<br />Christian convictions are the same.",
    banner: "https://www.messiah.edu/images/2_HarmonyDifference.jpg",
  },
  {
    name: "Wisdom-Expertise",
    preview: "https://www.messiah.edu/site/custom_scripts/styles/img/about/see-anew-4.png",
    intro: "The “outcome” of bringing together wisdom and expertise is:",
    outcome: "Authentic power to lead",
    description:
      "Biology students<br />explore art history;<br />nursing students<br />study practical theology.<br />Because Messiah professors<br />teach us how,<br />rooted in the context of why,<br />we learn to make<br />deeply considered decisions.<br />In other words,<br />we learn to be leaders.",
    banner: "https://www.messiah.edu/images/5_WisdomExpertise.jpg",
  },
  {
    name: "Worship-Service",
    preview: "https://www.messiah.edu/site/custom_scripts/styles/img/about/see-anew-5.png",
    intro: "The “outcome” of bringing together service and worship is:",
    outcome: "A sense of calling",
    description:
      "We gather to pray and sing,<br />to stand before God<br />and ask: How shall we live?<br />In service learning,<br />we find an answer.<br />We discover that our lives<br />are not theoretical<br />that our gifts have a vital place,<br />that our actions can be<br />an influence for good.",
    banner: "https://www.messiah.edu/images/7_WorshipService.jpg",
  },
  {
    name: "Home-Journey",
    preview: "https://www.messiah.edu/site/custom_scripts/styles/img/about/see-anew-6.png",
    intro: "The “outcome” of bringing together home and journey is:",
    outcome: "A worldwide sense of belonging",
    description:
      "A semester in Rome.<br />A service trip to Zambia.<br />Three weeks<br />immersed in the culture and<br />landscape of New Zealand.<br />Messiah draws me<br />into the world, and I realize—<br />I am a global citizen,<br />no longer free to imagine<br />that my tiny place<br />is all that matters.<br />From all over the earth,<br />we redefine the<br />meaning of home.",
    banner: "https://www.messiah.edu/images/3_HomeJourney.jpg",
  },
];
---

<section
  id="see-anew"
  class="text-white scroll-m-24 relative bg-[url(/images/see-anew-bg.png)] bg-no-repeat bg-cover bg-primary-800 py-24"
>
  <div class="wrapper">
    <h2 class="h2 text-center">See anew at Messiah University</h2>
    <p class="text-center max-w-4xl mx-auto paragraph">
      The heart of “see anew” is the concept of transformation and reconciliation. Our alumni
      consistently tell us that their experience at Messiah was transforming—that it helped them see
      themselves, their faith, their career, and the world in exciting new ways. They also share
      that a Messiah education equipped them to navigate life's tensions and bring together
      seemingly incompatible people and ideas. We believe that this is exactly what the college
      years should be like for students, especially a Christ-centered college experience that’s
      rooted in the transformation we undergo as we follow Jesus together.
    </p>

    <ul class="grid grid-cols-3 gap-8 mt-8">
      {
        items.map((item, index) => (
          <li>
            <button
              data-see-anew-trigger={`see-anew-tabpanel-${index}`}
              type="button"
              class="group font-title w-full font-bold text-center text-3xl flex flex-col items-center"
            >
              <img
                src={item.preview}
                alt=""
                class="mb-2 rounded-full group-hover:opacity-75 transition-opacity"
              />
              {item.name}
            </button>
          </li>
        ))
      }
    </ul>
  </div>

  <dialog
    data-see-anew-dialog
    class="bg-[url(/images/see-anew-bg.png)] bg-no-repeat bg-cover bg-primary-950 absolute inset-0 w-full h-full overflow-y-auto"
  >
    <div class="wrapper py-24 text-white">
      <header class="flex items-center justify-center relative">
        <h3 class="text-center h2">See anew</h3>
        <button
          type="button"
          class="absolute right-0 hover:text-tertiary-400 transition-colors"
          aria-label="close dialog"
          data-see-anew-close
        >
          <Icon name="close" class="size-10" />
        </button>
      </header>

      <div role="tablist" class="flex gap-x-8 gap-y-4 flex-wrap mt-8 justify-center">
        {
          items.map((item, index) => (
            <button
              class="font-title uppercase font-bold text-2xl border-b-2 border-spacing-2 border-transparent aria-selected:border-tertiary-400 aria-selected:text-tertiary-400"
              type="button"
              role="tab"
              aria-selected={index === 0 ? "true" : "false"}
              id={`see-anew-tab-${index}`}
              aria-controls={`see-anew-tabpanel-${index}`}
            >
              {item.name}
            </button>
          ))
        }
      </div>

      {
        items.map((item, index) => (
          <div
            class=""
            id={`see-anew-tabpanel-${index}`}
            role="tabpanel"
            data-tab-value={item.name}
            hidden={index === 0 ? undefined : ""}
            aria-labelledby={`see-anew-tab-${index}`}
          >
            <h4 class="text-center text-3xl my-12 relative before:absolute before:w-1/3 before:h-1 before:bg-gray-400 before:left-0 before:top-1/2 after:absolute after:w-1/3 after:h-1 after:bg-gray-400 after:right-0 after:top-1/2">
              {item.name}
            </h4>

            <div class="flex gap-4 max-w-lg mx-auto">
              <img src={item.banner} alt="" class="max-h-[350px]" />

              <div>
                <p class="text-2xl mb-4">{item.intro}</p>
                <p class="text-7xl font-bold font-title mb-4 leading-[0.75]">{item.outcome}</p>
                <div set:html={item.description} class="paragraph" />
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </dialog>
</section>

<script>
  let buttons = document.querySelectorAll<HTMLButtonElement>("[data-see-anew-trigger]");
  let dialog = document.querySelector<HTMLDialogElement>("[data-see-anew-dialog]");
  let close = dialog?.querySelector<HTMLButtonElement>("[data-see-anew-close]");
  let tabs = document.querySelectorAll<HTMLButtonElement>('button[role="tab"]');
  let panels = document.querySelectorAll<HTMLDivElement>('[role="tabpanel"]');

  function handleSelectTab(tab: string) {
    let button = Array.from(tabs).find((b) => b.getAttribute("aria-controls") === tab);

    tabs.forEach((tab) => {
      tab.setAttribute("aria-selected", "false");
    });

    panels.forEach((panel) => {
      panel.setAttribute("hidden", "");

      if (panel.getAttribute("id") === tab) {
        panel.removeAttribute("hidden");
        button?.setAttribute("aria-selected", "true");
      }
    });
  }

  buttons.forEach((button) => {
    button.addEventListener("click", () => {
      let target = button.getAttribute("data-see-anew-trigger");

      if (target) {
        handleSelectTab(target);
      }

      dialog?.show();
    });
  });

  window.addEventListener("keydown", (event) => {
    if (event.key === "Escape") {
      dialog?.close();
    }
  });

  close?.addEventListener("click", () => dialog?.close());

  tabs.forEach((tab) => {
    tab.addEventListener("click", (event) => {
      let target = (event.target as HTMLButtonElement).getAttribute("aria-controls");

      if (target) {
        handleSelectTab(target);
      }
    });
  });
</script>
