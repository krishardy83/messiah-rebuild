---
import { cn } from "../../lib/utils";

const slides = [
  {
    title: "Falcon Fridays are a great way to experience campus this summer!",
    description:
      "Tour our amazing campus, check out our exciting academic programs and spiritual growth opportunities-- and, of course, stick around for some ice cream!",
    button: "Become a student",
    image: "https://www.messiah.edu/images/ff.jpg",
    links: [
      {
        href: "https://www.messiah.edu/info/23324/falcon_fridays?element=homepage-car",
        label: "Learn more",
      },
    ],
  },
  {
    title: "Academic Excellence",
    description: "Experience the academic distinction of a nationally ranked Christian college",
    image: "https://www.messiah.edu/images/hero_academics.jpg",
    button: "Academic excellence",
    links: [
      {
        href: "https://www.messiah.edu/majors-minors-programs",
        label: "Undergrad programs",
      },
      {
        href: "http://www.messiah.edu/info/20436/degrees",
        label: "Graduate programs",
      },
    ],
  },
  {
    title: "Careers and Internships",
    description: "Explore your calling â€” from your first year through graduation",
    button: "Careers & internships",
    image: "https://www.messiah.edu/images/career_hero.jpg",
    links: [
      {
        href: "https://www.messiah.edu/career-outcomes",
        label: "Undergrad outcomes",
      },
      {
        href: "https://www.messiah.edu/grad-careers",
        label: "Graduate outcomes",
      },
    ],
  },
  {
    title: "Study Abroad",
    description: "Where in the world will you go?",
    button: "Study abroad",
    image: "https://www.messiah.edu/images/travel_hero.jpg",
    links: [
      {
        href: "https://www.messiah.edu/study-abroad",
        label: "Explore undergrad opportunities",
      },
    ],
  },
];
---

<div class="relative flex flex-col-reverse -mt-48" data-analytics="hero">
  <div
    role="tablist"
    class="hidden sm:flex absolute bottom-0 left-0 right-0 sm:bg-gradient-to-t from-black/75 to-transparent items-center flex-wrap"
  >
    {
      slides.map((slide, index) => (
        <button
          type="button"
          id={`tab-${index}`}
          role="tab"
          aria-selected={index === 0}
          class="text-white w-full sm:w-1/2 md:w-1/4 text-lg uppercase p-4 md:p-8 link text-center font-title font-bold aria-selected:text-tertiary-400 group"
          aria-controls={`tabpanel-${index}`}
        >
          <span class="inline-block border-b-4 border-transparent group-aria-selected:border-tertiary-400 pointer-events-none">
            {slide.button}
          </span>
        </button>
      ))
    }
  </div>
  {
    slides.map((slide, index) => (
      <div
        role="tabpanel"
        tabindex="0"
        aria-labelledby={`tab-${index}`}
        id={`tabpanel-${index}`}
        class={cn(
          "w-full h-[75vw] min-h-[800px] max-h-[1200px] items-center bg-primary-800 bg-[linear-gradient(to_bottom,rgba(0,0,0,0.75),transparent),var(--bg-banner)] bg-cover bg-no-repeat",
          index === 0 ? "flex" : "hidden"
        )}
        style={{ "--bg-banner": `url(${slide.image})` }}
      >
        <div class="max-w-[2100px] mx-auto px-4 lg:px-12 w-full">
          <p class="text-white h2 max-w-2xl">{slide.title}</p>
          <p class="text-white text-lg md:text-xl max-w-xl mb-8">{slide.description}</p>
          <div class="flex gap-2">
            {slide.links.map((link) => (
              <a href={link.href} class="btn-quaternary">
                {link.label}
              </a>
            ))}
          </div>
        </div>
      </div>
    ))
  }
</div>

<script>
  let tabs = document.querySelectorAll('button[role="tab"]');
  let panels = document.querySelectorAll('[role="tabpanel"]');

  function handleTabClick(event: Event) {
    let button = event.target as HTMLButtonElement;
    let target = button.getAttribute("aria-controls");

    if (target) {
      tabs.forEach((tab) => {
        tab.setAttribute("aria-selected", "false");
      });

      panels.forEach((panel) => {
        panel.classList.add("hidden");

        if (panel.getAttribute("id") === target) {
          panel.classList.remove("hidden");
          panel.classList.add("flex");
          button.setAttribute("aria-selected", "true");
        }
      });
    }
  }

  tabs.forEach((tab) => tab.addEventListener("click", handleTabClick));
</script>
